<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Angebot abgeben - Versandwerk</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  </head>
  <body class="bg-gray-100">
    <div class="min-h-screen py-12 px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-8">
          <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Angebot abgeben</h1>
            <p class="mt-2 text-gray-600">Transportanfrage #<%= @carrier_request.transport_request.id %></p>
          </div>

          <!-- Transport Request Details -->
          <div class="bg-gray-50 rounded-lg p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">Transportdetails</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <dt class="text-sm font-medium text-gray-500">Abholung</dt>
                <dd class="mt-1 text-sm text-gray-900">
                  <%= @carrier_request.transport_request.start_address %><br>
                  <span class="text-gray-500">
                    <%= @carrier_request.transport_request.pickup_date_from&.strftime("%d.%m.%Y %H:%M") %>
                  </span>
                </dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Zustellung</dt>
                <dd class="mt-1 text-sm text-gray-900">
                  <%= @carrier_request.transport_request.destination_address %><br>
                  <span class="text-gray-500">
                    <%= @carrier_request.transport_request.delivery_date_from&.strftime("%d.%m.%Y %H:%M") %>
                  </span>
                </dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Strecke</dt>
                <dd class="mt-1 text-sm text-gray-900"><%= @carrier_request.transport_request.distance_km %> km</dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Fahrzeugtyp</dt>
                <dd class="mt-1 text-sm text-gray-900"><%= @carrier_request.transport_request.vehicle_type&.titleize %></dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Ladungsgewicht</dt>
                <dd class="mt-1 text-sm text-gray-900"><%= @carrier_request.transport_request.cargo_weight_kg %> kg</dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Entfernung zur Abholung</dt>
                <dd class="mt-1 text-sm text-gray-900"><%= @carrier_request.distance_to_pickup_km&.round(1) %> km</dd>
              </div>
            </div>

            <% if @carrier_request.transport_request.requires_liftgate ||
                  @carrier_request.transport_request.requires_pallet_jack ||
                  @carrier_request.transport_request.requires_gps_tracking %>
              <div class="mt-4">
                <dt class="text-sm font-medium text-gray-500 mb-2">Besondere Anforderungen</dt>
                <dd class="flex flex-wrap gap-2">
                  <% if @carrier_request.transport_request.requires_liftgate %>
                    <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded">Hebebühne</span>
                  <% end %>
                  <% if @carrier_request.transport_request.requires_pallet_jack %>
                    <span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded">Hubwagen</span>
                  <% end %>
                  <% if @carrier_request.transport_request.requires_gps_tracking %>
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">GPS</span>
                  <% end %>
                </dd>
              </div>
            <% end %>
          </div>

          <!-- Offer Form -->
          <%= form_with(url: submit_offer_offer_path(@carrier_request), method: :post, local: true, class: "space-y-6") do |f| %>
            <div>
              <%= f.label :offered_price, "Angebotspreis (€)", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= f.number_field :offered_price, step: "0.01", required: true, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
            </div>

            <div>
              <%= f.label :offered_delivery_date, "Lieferdatum", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= f.datetime_field :offered_delivery_date, required: true, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
            </div>

            <div>
              <%= f.label :transport_type, "Transportart", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= f.select :transport_type,
                  [['Transporter', 'transporter'], ['LKW', 'lkw']],
                  { prompt: 'Bitte wählen' },
                  { required: true, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" } %>
            </div>

            <div>
              <%= f.label :notes, "Anmerkungen (optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
              <%= f.text_area :notes, rows: 4, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
            </div>

            <div class="flex justify-end space-x-4">
              <%= f.submit "Angebot abgeben", class: "px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium text-lg" %>
            </div>
          <% end %>
        </div>

        <p class="text-center text-gray-500 text-sm mt-6">
          Bei Fragen kontaktieren Sie uns bitte.
        </p>
      </div>
    </div>
  </body>
</html>
